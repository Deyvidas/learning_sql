- [Использование LIMIT (лимит записей в окончательной выборке)](#4)
- [Использование DATEDIFF (вычитание из одной даты другую)](#5)
    - [Date and Time Functions](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html)
    - [MySQL DATE Data Type tutorial](https://www.mysqltutorial.org/mysql-date/)
- [Использование MONTH](#7)
- [Использование YEAR](#9)
- [Использование DATEADD INTERVAL](#10.1)
- [Использование REGEXP_LIKE (функция для регистр-зависимого поиска)](#5)
    - [REGEXP_LIKE tutorial](https://mysqlcode.com/mysql-regexp-like-function/)
- [SQL стандарт порядка выполнения инструкции](#8.1)

---

<h3 id="1" align="center">Задание 1</h3>

Вывести из таблицы trip информацию о командировках тех сотрудников, фамилия
которых заканчивается на букву «а», в отсортированном по убыванию даты
последнего дня командировки виде. В результат включить столбцы name, city,
per_diem, date_first, date_last.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT name,
         city,
         per_diem,
         date_first,
         date_last
    FROM trip
   WHERE name LIKE '_%а _._.%'
ORDER BY date_last DESC;
```
```text
name         |city           |per_diem|date_first|date_last |
-------------+---------------+--------+----------+----------+
Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="2" align="center">Задание 2</h3>

Вывести в алфавитном порядке фамилии и инициалы тех сотрудников, которые были в
командировке в Москве.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT name
    FROM trip
   WHERE city LIKE 'москва'
GROUP BY name
ORDER BY name ASC;
```
```text
name         |
-------------+
Абрамова К.А.|
Баранов П.Е. |
Колесов С.П. |
Лебедев Т.К. |
Семенов И.В. |
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="3" align="center">Задание 3</h3>

Для каждого города посчитать, сколько раз сотрудники в нем были.  Информацию
вывести в отсортированном в алфавитном порядке по названию городов. Вычисляемый
столбец назвать Количество.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT city,
         COUNT(*) AS Количество
    FROM trip
GROUP BY city
ORDER BY city ASC;
```
```text
city           |Количество|
---------------+----------+
Владивосток    |         3|
Воронеж        |         1|
Москва         |         7|
Новосибирск    |         4|
Санкт-Петербург|         3|
Томск          |         2|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="4" align="center">Задание 4</h3>

Вывести два города, в которых чаще всего были в командировках сотрудники.
Вычисляемый столбец назвать Количество.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT city,
         COUNT(*) AS Количество
    FROM trip
GROUP BY city
ORDER BY Количество DESC
   LIMIT 2;
```
```text
city       |Количество|
-----------+----------+
Москва     |         7|
Новосибирск|         4|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="5" align="center">Задание 5</h3>

Вывести информацию о командировках во все города кроме Москвы и
Санкт-Петербурга (фамилии и инициалы сотрудников, город, длительность
командировки в днях, при этом первый и последний день относится к периоду
командировки). Последний столбец назвать Длительность. Информацию вывести в
упорядоченном по убыванию длительности поездки, а потом по убыванию названий
городов (в обратном алфавитном порядке).

<p align="center">~~~</p>

__Теория про DATEDIFF:__<br>
Для вычитания двух дат используется функция DATEDIFF(дата_1, дата_2),
результатом которой является количество дней между дата_1 и дата_2. Например,

```sql
DATEDIFF('2020-04-01', '2020-03-28')  -- 4
DATEDIFF('2020-05-09', '2020-05-01')  -- 8
```

<p align="center">~~~</p>

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT name,
         city,
         DATEDIFF(date_last, date_first) + 1 AS Длительность
         -- + 1 так как date_first не учитывается;
    FROM trip
   WHERE NOT REGEXP_LIKE(city, '(москва|санкт-петербург)', 'i')  -- 'i' case insensitive;
ORDER BY Длительность DESC,
         city DESC;
```
```text
name         |city       |Длительность|
-------------+-----------+------------+
Ильиных Г.Р. |Владивосток|          22|
Баранов П.Е. |Новосибирск|          17|
Колесов С.П. |Новосибирск|          15|
Абрамова К.А.|Владивосток|          14|
Лебедев Т.К. |Томск      |          12|
Абрамова К.А.|Владивосток|          12|
Федорова А.Ю.|Новосибирск|          11|
Колесов С.П. |Новосибирск|          10|
Федорова А.Ю.|Томск      |           7|
Баранов П.Е. |Воронеж    |           7|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="6" align="center">Задание 6</h3>

Вывести информацию о командировках сотрудника(ов), которые были самыми
короткими по времени. В результат включить столбцы name, city, date_first,
date_last.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03| <- MIN
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

<details><summary>Вложенный запрос</summary>

```sql
SELECT @min_datediff := MIN(DATEDIFF(date_last, date_first))
  FROM trip;
```
```text
@min_datediff := MIN(DATEDIFF(date_last, date_first))|
-----------------------------------------------------+
                                                    2|
```

</details>

<p align="center">~~~</p>

```sql
SELECT name,
       city,
       date_first,
       date_last
  FROM trip
 WHERE (SELECT @min_datediff := MIN(DATEDIFF(date_last, date_first))
          FROM trip)
   AND DATEDIFF(date_last, date_first) = @min_datediff;
```
```text
name        |city           |date_first|date_last |
------------+---------------+----------+----------+
Семенов И.В.|Санкт-Петербург|2020-06-01|2020-06-03|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="7" align="center">Задание 7</h3>

Вывести информацию о командировках, начало и конец которых относятся к одному
месяцу (год может быть любой). В результат включить столбцы name, city,
date_first, date_last. Строки отсортировать сначала в алфавитном порядке по
названию города, а затем по фамилии сотрудника.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

</details>

```sql
  SELECT name,
         city,
         date_first,
         date_last
    FROM trip
   WHERE MONTH(date_first) = MONTH(date_last)
ORDER BY city ASC,
         name ASC;
```
```text
name         |city           |date_first|date_last |
-------------+---------------+----------+----------+
Абрамова К.А.|Владивосток    |2020-01-14|2020-01-27|
Абрамова К.А.|Владивосток    |2020-07-02|2020-07-13|
Баранов П.Е. |Воронеж        |2020-07-19|2020-07-25|
Абрамова К.А.|Москва         |2020-04-06|2020-04-14|
Баранов П.Е. |Москва         |2020-01-12|2020-01-17|
Баранов П.Е. |Москва         |2020-02-14|2020-02-22|
Колесов С.П. |Москва         |2020-02-01|2020-02-06|
Лебедев Т.К. |Москва         |2020-03-03|2020-03-06|
Семенов И.В. |Москва         |2020-01-23|2020-01-31|
Колесов С.П. |Новосибирск    |2020-06-03|2020-06-12|
Семенов И.В. |Санкт-Петербург|2020-06-01|2020-06-03|
Лебедев Т.К. |Томск          |2020-05-20|2020-05-31|
Федорова А.Ю.|Томск          |2020-06-20|2020-06-26|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="8" align="center">Задание 8</h3>

Вывести название месяца и количество командировок для каждого месяца. Считаем,
что командировка относится к некоторому месяцу, если она началась в этом месяце.
Информацию вывести сначала в отсортированном по убыванию количества, а потом в
алфавитном порядке по названию месяца виде. Название столбцов – Месяц и
Количество.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

<p align="center">~~~</p>

</details>

```sql
  SELECT MONTHNAME(date_first) AS Месяц,
         COUNT(*) AS Количество
    FROM trip
GROUP BY MONTHNAME(date_first)
ORDER BY Количество DESC,
         Месяц ASC;
```

<p align="center">ИЛИ<br><b>(так лучше не делать, что-бы не зависеть от платформы)</b></p>

```sql
  SELECT MONTHNAME(date_first) AS Месяц,
         COUNT(*) AS Количество
    FROM trip
GROUP BY Месяц  -- Так как в MySQL SELECT выполняется перед GROUP BY;
ORDER BY Количество DESC,
         Месяц ASC;
```

<h3 id="8.1" align="center">SQL стандарт порядка выполнения инструкции</h3>

```sql
По стандарту SQL порядок выполнения следующий:
     1.     FROM ...
     2.    WHERE ...
     3. GROUP BY ...
     4.   HAVING ...
     5.   SELECT ...
     6. ORDER BY ...
     7.    LIMIT ...;
```

<p align="center">~~~</p>

```text
Месяц   |Количество|
--------+----------+
February|         4|
January |         4|
June    |         3|
May     |         3|
April   |         2|
July    |         2|
March   |         2|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="9" align="center">Задание 9</h3>

Вывести сумму суточных (произведение количества дней командировки и размера
суточных) для командировок, первый день которых пришелся на февраль или март
2020 года. Значение суточных для каждой командировки занесено в столбец
per_diem. Вывести фамилию и инициалы сотрудника, город, первый день
командировки и сумму суточных. Последний столбец назвать Сумма. Информацию
отсортировать сначала  в алфавитном порядке по фамилиям сотрудников, а затем
по убыванию суммы суточных.

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-02-02|
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

<p align="center">~~~</p>

</details>

```sql
  SELECT name,
         city,
         date_first,
         per_diem * (DATEDIFF(date_last, date_first) + 1) AS Сумма
    FROM trip
   WHERE MONTH(date_first) IN ('02', '03')
     AND YEAR(date_first) = '2020'
ORDER BY name ASC,
         Сумма DESC;
```
```text
name         |city           |date_first|Сумма  |
-------------+---------------+----------+-------+
Абрамова К.А.|Москва         |2020-02-23|5600.00|
Баранов П.Е. |Москва         |2020-02-14|6300.00|
Колесов С.П. |Новосибирск    |2020-02-27|6750.00|
Колесов С.П. |Москва         |2020-02-01|4200.00|
Лебедев Т.К. |Москва         |2020-03-03|2800.00|
Семенов И.В. |Санкт-Петербург|2020-03-29|5600.00|
```

<!-- @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ -->

---

<h3 id="10" align="center">Задание 10</h3>

Вывести фамилию с инициалами и общую сумму суточных, полученных за все
командировки для тех сотрудников, которые были в командировках больше чем 3
раза, в отсортированном по убыванию сумм суточных виде. Последний столбец
назвать Сумма.

<details><summary>Только для этого задания изменена строка таблицы trip</summary>

```sql
SELECT *
  FROM trip
 WHERE trip_id = 4;
```
```text
trip_id|name        |city       |per_diem|date_first|date_last |
-------+------------+-----------+--------+----------+----------+
      4|Ильиных Г.Р.|Владивосток|  450.00|2020-01-12|2020-02-02|
                                                     ^^^^^^^^^^
```

<p id="10.1" align="center">~~~</p>

```sql
UPDATE trip
   SET date_last = DATE_ADD(date_last, INTERVAL 1 MONTH)
 WHERE trip_id = 4;

Updated Rows 1
```

<p align="center">~~~</p>

```sql
SELECT *
  FROM trip
 WHERE trip_id = 4;
```
```text
trip_id|name        |city       |per_diem|date_first|date_last |
-------+------------+-----------+--------+----------+----------+
      4|Ильиных Г.Р.|Владивосток|  450.00|2020-01-12|2020-03-02|
                                                     ^^^^^^^^^^
```

</details>

<details><summary>Таблица</summary>

```sql
SELECT * FROM trip;
```
```text
trip_id|name         |city           |per_diem|date_first|date_last |
-------+-------------+---------------+--------+----------+----------+
      1|Баранов П.Е. |Москва         |  700.00|2020-01-12|2020-01-17|
      2|Абрамова К.А.|Владивосток    |  450.00|2020-01-14|2020-01-27|
      3|Семенов И.В. |Москва         |  700.00|2020-01-23|2020-01-31|
      4|Ильиных Г.Р. |Владивосток    |  450.00|2020-01-12|2020-03-02| <-
                                                               ^^
      5|Колесов С.П. |Москва         |  700.00|2020-02-01|2020-02-06|
      6|Баранов П.Е. |Москва         |  700.00|2020-02-14|2020-02-22|
      7|Абрамова К.А.|Москва         |  700.00|2020-02-23|2020-03-01|
      8|Лебедев Т.К. |Москва         |  700.00|2020-03-03|2020-03-06|
      9|Колесов С.П. |Новосибирск    |  450.00|2020-02-27|2020-03-12|
     10|Семенов И.В. |Санкт-Петербург|  700.00|2020-03-29|2020-04-05|
     11|Абрамова К.А.|Москва         |  700.00|2020-04-06|2020-04-14|
     12|Баранов П.Е. |Новосибирск    |  450.00|2020-04-18|2020-05-04|
     13|Лебедев Т.К. |Томск          |  450.00|2020-05-20|2020-05-31|
     14|Семенов И.В. |Санкт-Петербург|  700.00|2020-06-01|2020-06-03|
     15|Абрамова К.А.|Санкт-Петербург|  700.00|2020-05-28|2020-06-04|
     16|Федорова А.Ю.|Новосибирск    |  450.00|2020-05-25|2020-06-04|
     17|Колесов С.П. |Новосибирск    |  450.00|2020-06-03|2020-06-12|
     18|Федорова А.Ю.|Томск          |  450.00|2020-06-20|2020-06-26|
     19|Абрамова К.А.|Владивосток    |  450.00|2020-07-02|2020-07-13|
     20|Баранов П.Е. |Воронеж        |  450.00|2020-07-19|2020-07-25|
```

<p align="center">~~~</p>

</details>

```sql
  SELECT name,
         SUM(per_diem * (DATEDIFF(date_last, date_first) + 1)) AS Сумма
    FROM trip
GROUP BY name
  HAVING COUNT(*) > 3
ORDER BY Сумма DESC;
```
```text
name         |Сумма   |
-------------+--------+
Абрамова К.А.|29200.00|
Баранов П.Е. |21300.00|
```